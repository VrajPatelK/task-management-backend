-- USERS
CREATE TABLE USERS
(
    id SERIAL INT,
    email VARCHAR(255) UNIQUE NOT NULL,
    username VARCHAR(255) NOT NULL,
    password VARCHAR(255) NOT NULL,
    user_type VARCHAR(255) CHECK (user_type = 'admin' or user_type = 'developer') NOT NULL,
    profile_img VARCHAR(255) DEFAULT 'https://firebasestorage.googleapis.com/v0/b/task-management-fbb64.appspot.com/o/profile_images%2Fdefault-profile-img.png?alt=media&token=dbab22ee-13fe-4b80-b7a5-7209944a775a',

    PRIMARY KEY(id)
)


ALTER TABLE USERS
ADD CONSTRAINT check_user_type
CHECK (user_type = 'admin' or user_type = 'developer');

ALTER TABLE USERS
ALTER COLUMN profile_img SET DEFAULT 'https://firebasestorage.googleapis.com/v0/b/task-management-fbb64.appspot.com/o/profile_images%2Fdefault-profile-img.png?alt=media&token=dbab22ee-13fe-4b80-b7a5-7209944a775a';

-- Step 1: Drop the existing column
ALTER TABLE USERS
DROP COLUMN id;

-- Step 2: Add the column as SERIAL
ALTER TABLE USERS
ADD COLUMN id SERIAL;


-- TASKS
CREATE TABLE TASKS
(
    id SERIAL INT,
    title VARCHAR(255) NOT NULL,
    description VARCHAR(255) NOT NULL,
    status VARCHAR(255) CHECK(status = 'pending' or status = 'in-progress' or status = 'completed') DEFAULT 'pending',
    created_at timestamp NOT NULL,
    deadline timestamp,
    created_by INT NOT NULL,
    assigned_to INT,

    PRIMARY KEY(id),
    FOREIGN KEY(created_by) REFERENCES USERS(id),
    FOREIGN KEY(assigned_to) REFERENCES USERS(id)
)